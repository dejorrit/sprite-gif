!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.SpriteGif=e():t.SpriteGif=e()}(window,function(){return function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e),i.d(e,"default",function(){return n});const s={autostart:!0,frameRate:30,loop:!0,speed:1};class n{constructor(t,e){if(this.el=t,this.settings=Object.assign({},s,e),!e.sprite)throw new Error("no sprite defined");this.isPlaying=!1,this._animate=this._animate.bind(this),this._onSpriteLoaded=this._onSpriteLoaded.bind(this),this._loadSprite().then(t=>{this._onSpriteLoaded(t)})}play(){this.isPlaying||(this.isPlaying=!0,this._requestAF())}pause(){this.isPlaying&&(this.lastStepTimestamp=null,this.isPlaying=!1,this._cancelAF())}stop(){this._stopAtEnd(),this._renderFrame(1)}setLoop(t){if("boolean"!=typeof t)throw new Error("loop setting not of type Boolean");this.settings.loop=t}setSpeed(t){if("number"!=typeof t)throw new Error("speed setting not of type number");this.settings.speed=t}setFrameRate(t){if("number"!=typeof t)throw new Error("frameRate not of type number");this.settings.frameRate}renderFrame(t){this._renderFrame(t)}_loadSprite(){return new Promise((t,e)=>{let i=new Image;i.onload=(()=>i.naturalWidth?t(i):e()),i.src=this.settings.sprite})}_onSpriteLoaded(t){let e=this._getHeight()/t.naturalHeight;this.frames=Math.round(t.naturalWidth*e/this._getWidth()),this._insertSprite(),this._renderFrame(1),this.settings.onLoaded&&"function"==typeof this.settings.onLoaded&&this.settings.onLoaded(),this.settings.autostart&&this.play()}_insertSprite(){this.el.style.backgroundImage=`url('${this.settings.sprite}')`,this.el.style.backgroundSize=`${100*this.frames}% auto`}_animate(t){let e=1e3/(this.settings.frameRate*this.settings.speed),i=t-(this.lastStepTimestamp?this.lastStepTimestamp:t),s=(this.animatingTime?this.animatingTime:0)+i,n=Math.round(s/e)+1;this.lastStepTimestamp=t,this.animatingTime=s,n>this.frames?this._onEnd():(this._renderFrame(n),this._requestAF())}_onEnd(){this.animatingTime=null,this.lastStepTimestamp=null,this.settings.loop?(this._renderFrame(1),this._requestAF()):(window.console.log("onEnd","stop"),this._stopAtEnd())}_stopAtEnd(){this.isPlaying=!1,this._resetTimers(),this._cancelAF()}_requestAF(){this.raf=window.requestAnimationFrame(this._animate)}_cancelAF(){this.raf&&window.cancelAnimationFrame(this.raf)}_renderFrame(t){if((t=Math.min(t,this.frames))!==this.currentFrame){let e=(t-1)/(this.frames-1)*100;this.el.style.backgroundPositionX=`${e}%`,this.el.style.backgroundPositionY="0px",this.currentFrame=t}}_resetTimers(){this.lastFrameTime=null}_getWidth(){return this.el.offsetWidth}_getHeight(){return this.el.offsetHeight}}}])});